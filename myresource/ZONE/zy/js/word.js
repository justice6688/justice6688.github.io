"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var get={byId:function(t){return"string"==typeof t?document.getElementById(t):t},byClass:function(t,e){for(var n=[],a=new RegExp("(^| )"+t+"( |$)"),s=this.byTagName("*",e),l=0;l<s.length;l++)a.test(s[l].className)&&n.push(s[l]);return n},byTagName:function(t,e){return(e||document).getElementsByTagName(t)}},EventUtil={addHandler:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):(t["_"+e+n]=n,t[e+n]=function(){t["_"+e+n]()},t.attachEvent("on"+e,t[e+n]))},removeHandler:function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,t[e+n])},addLoadHandler:function(t){this.addHandler(window,"load",t)}};function css(t,e,n){switch(arguments.length){case 2:if("object"!=_typeof(e))return(t.currentStyle||getComputedStyle(t,null))[e];for(var a in e)"opacity"==a?(t.style.filter="alpha(opacity="+e[a]+")",t.style[a]=e[a]/100):t.style[a]=e[a];break;case 3:"opacity"==e?(t.style.filter="alpha(opacity="+n+")",t.style[e]=n/100):t.style[e]=n}}EventUtil.addLoadHandler(function(){var s=get.byId("msgBox"),l=get.byId("userName"),o=get.byId("conBox"),t=get.byId("sendBtn"),e=get.byClass("maxNum")[0],n=get.byClass("countTxt")[0],a=get.byClass("list")[0],i=get.byTagName("ul",a)[0],r=get.byTagName("li",a),c=get.byClass("f-text",s),d=get.byTagName("img",get.byId("face")),u=!1,f=null,v="",g=0;function y(){var t=/^\s*$/g;if(t.test(l.value))alert("请填写您的姓名"),l.focus();else if(/^[u4e00-\u9fa5\w]{2,8}$/g.test(l.value))if(t.test(o.value))alert("随便说点什么吧！"),o.focus();else if(u){var e=document.createElement("li"),t=new Date;for(e.innerHTML='<div class="userPic"><img src="'+get.byClass("current",get.byId("face"))[0].src+'"></div>\t\t\t\t\t\t\t <div class="content">\t\t\t\t\t\t\t \t<div class="userName"><a href="javascript:;">'+l.value+'</a>:</div>\t\t\t\t\t\t\t\t<div class="msgInfo">'+o.value.replace(/<[^>]*>|&nbsp;/gi,"")+'</div>\t\t\t\t\t\t\t\t<div class="times"><span>'+b(t.getMonth()+1)+"月"+b(t.getDate())+"日 "+b(t.getHours())+":"+b(t.getMinutes())+'</span><a class="del" href="javascript:;">删除</a></div>\t\t\t\t\t\t\t </div>',r.length?i.insertBefore(e,r[0]):i.appendChild(e),get.byTagName("form",s)[0].reset(),g=0;g<d.length;g++)d[g].className="";d[0].className="current";var n=e.clientHeight-parseFloat(css(e,"paddingTop"))-parseFloat(css(e,"paddingBottom")),a=count=0;css(e,{opacity:"0",height:"0"}),f=setInterval(function(){css(e,{display:"block",opacity:"0",height:(count+=8)+"px"}),count>n&&(clearInterval(f),css(e,"height",n+"px"),f=setInterval(function(){css(e,"opacity",a+=10),100<a&&(clearInterval(f),css(e,"opacity",100))},30))},30),h(),p()}else alert("你输入的内容已超出限制，请检查！"),o.focus();else alert("姓名由2-8位字母、数字、下划线、汉字组成！"),l.focus()}function m(){var t=0;for(g=0;g<o.value.length;g++)t+=/[^\x00-\xff]/g.test(o.value.charAt(g))?1:.5;e.innerHTML=Math.abs(140-Math.floor(t)),u=0<=140-Math.floor(t)?(css(e,"color",""),n.innerHTML="还能输入",!0):(css(e,"color","#f60"),!(n.innerHTML="已超出"))}function h(){for(g=0;g<r.length;g++)EventUtil.addHandler(r[g],"mouseover",function(t){this.className="hover",v=get.byClass("times",this)[0];var e=get.byTagName("a",v);e.length?e[0].style.display="block":((e=document.createElement("a")).innerHTML="删除",e.className="del",e.href="javascript:;",v.appendChild(e))}),EventUtil.addHandler(r[g],"mouseout",function(){this.className="",get.byTagName("a",get.byClass("times",this)[0])[0].style.display="none"})}function p(){var t=get.byClass("del",i);for(g=0;g<t.length;g++)t[g].onclick=function(){var t=this.parentNode.parentNode.parentNode,e=100,n=t.offsetHeight;f=setInterval(function(){css(t,"opacity",e-=10),e<0&&(clearInterval(f),f=setInterval(function(){css(t,"height",(n=(n-=10)<0?0:n)+"px"),0==n&&(clearInterval(f),i.removeChild(t))},30))},30),this.onclick=null}}for(EventUtil.addHandler(get.byTagName("form",s)[0],"submit",function(){return!1}),EventUtil.addHandler(t,"click",y),EventUtil.addHandler(document,"keyup",function(t){(t=t||window.event).ctrlKey&&13==t.keyCode&&y()}),EventUtil.addHandler(o,"keyup",m),EventUtil.addHandler(o,"focus",m),EventUtil.addHandler(o,"change",m),m(),EventUtil.addHandler(t,"mouseover",function(){this.className="hover"}),EventUtil.addHandler(t,"mouseout",function(){this.className=""}),h(),p(),g=0;g<c.length;g++)EventUtil.addHandler(c[g],"focus",function(){this.className="active"}),EventUtil.addHandler(c[g],"blur",function(){this.className=""});function b(t){return t.toString().replace(/^(\d)$/,"0$1")}for(g=0;g<d.length;g++)d[g].onmouseover=function(){this.className+=" hover"},d[g].onmouseout=function(){this.className=this.className.replace(/\s?hover/,"")},d[g].onclick=function(){for(g=0;g<d.length;g++)d[g].className="";this.className="current"}});